import{K as _,V as g,a2 as h,W as y,v as b,M as p,y as d,F as k,ag as w,N as A,w as E,A as T,ah as M,B as N,H as S,C as F,x,E as v,ai as m,O as D,a as R,aj as B,ak as C,s as O}from"./cQRvxpQ7.js";import{s as H,g as I}from"./8qmZiPQS.js";class U{anchor;#s=new Map;#t=new Map;#e=new Map;#a=new Set;#r=!0;constructor(s,t=!0){this.anchor=s,this.#r=t}#i=()=>{var s=_;if(this.#s.has(s)){var t=this.#s.get(s),e=this.#t.get(t);if(e)g(e),this.#a.delete(t);else{var n=this.#e.get(t);n&&(this.#t.set(t,n.effect),this.#e.delete(t),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),e=n.effect)}for(const[r,i]of this.#s){if(this.#s.delete(r),r===s)break;const f=this.#e.get(i);f&&(h(f.effect),this.#e.delete(i))}for(const[r,i]of this.#t){if(r===t||this.#a.has(r))continue;const f=()=>{if(Array.from(this.#s.values()).includes(r)){var o=document.createDocumentFragment();w(i,o),o.append(b()),this.#e.set(r,{effect:i,fragment:o})}else h(i);this.#a.delete(r),this.#t.delete(r)};this.#r||!e?(this.#a.add(r),y(i,f,!1)):f()}}};#n=s=>{this.#s.delete(s);const t=Array.from(this.#s.values());for(const[e,n]of this.#e)t.includes(e)||(h(n.effect),this.#e.delete(e))};ensure(s,t){var e=_,n=A();if(t&&!this.#t.has(s)&&!this.#e.has(s))if(n){var r=document.createDocumentFragment(),i=b();r.append(i),this.#e.set(s,{effect:p(()=>t(i)),fragment:r})}else this.#t.set(s,p(()=>t(this.anchor)));if(this.#s.set(e,s),n){for(const[f,c]of this.#t)f===s?e.skipped_effects.delete(c):e.skipped_effects.add(c);for(const[f,c]of this.#e)f===s?e.skipped_effects.delete(c.effect):e.skipped_effects.add(c.effect);e.oncommit(this.#i),e.ondiscard(this.#n)}else d&&(this.anchor=k),this.#i()}}function L(a,s,t=!1){d&&T();var e=new U(a),n=t?M:0;function r(i,f){if(d){const o=N(a)===S;if(i===o){var c=F();x(c),e.anchor=c,v(!1),e.ensure(i,f),v(!0);return}}e.ensure(i,f)}E(()=>{var i=!1;s((f,c=!0)=>{i=!0,r(c,f)}),i||r(!1,null)},n)}let u=!1,l=Symbol();function P(a,s,t){const e=t[s]??={store:null,source:D(void 0),unsubscribe:m};if(e.store!==a&&!(l in t))if(e.unsubscribe(),e.store=a??null,a==null)e.source.v=void 0,e.unsubscribe=m;else{var n=!0;e.unsubscribe=H(a,r=>{n?e.source.v=r:O(e.source,r)}),n=!1}return a&&l in t?I(a):R(e.source)}function V(a,s){return a.set(s),s}function W(){const a={};function s(){B(()=>{for(var t in a)a[t].unsubscribe();C(a,l,{enumerable:!1,value:!0})})}return[a,s]}function Y(a){var s=u;try{return u=!1,[a(),u]}finally{u=s}}export{U as B,P as a,V as b,Y as c,L as i,W as s};
